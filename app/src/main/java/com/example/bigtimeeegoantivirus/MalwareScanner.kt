package com.example.bigtimeeegoantivirus



import android.util.Log
import com.google.firebase.database.*

class MalwareScanner {

    private val database = FirebaseDatabase.getInstance().getReference("malware_hashes")

    fun checkMalware(fileHash: String, callback: (Boolean, String) -> Unit) {
        database.child(fileHash).addListenerForSingleValueEvent(object : ValueEventListener {
            override fun onDataChange(snapshot: DataSnapshot) {
                if (snapshot.exists()) {
                    val malwareName = snapshot.value.toString()
                    callback(true, malwareName)
                } else {
                    callback(false, "No threats found")
                }
            }

            override fun onCancelled(error: DatabaseError) {
                Log.e("MalwareScanner", "Database error: ${error.message}")
                callback(false, "Error checking database")
            }
        })
    }
}
